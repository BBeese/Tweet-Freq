import tweepy
from tweepy import OAuthHandler

import matplotlib.pyplot as plt

def StringCleaning(s):
    string = ""
    for char in s:
        if (ord(char) > 122) or ((ord(char) < 97) and (char != "'")) or ("https://" in s):
            continue
        else:
            string = string + char
    return string

def main():
    
    appKey = "redacted"
    appSecret = "redacted"
    authToken = "redacted"
    authSecret = "redacted"

    auth = OAuthHandler(appKey, appSecret)
    auth.set_access_token(authToken, authSecret)

    api = tweepy.API(auth)

    handle = str(input("Enter the user's twitter handle: @"))

    alltweets = api.user_timeline(screen_name = handle, count = 200, include_rts = False)

    outtweets = [[tweet.text] for tweet in alltweets]

    wordDict = {}
    for tweets in outtweets:
        for words in tweets:
            words = words.lower().split()
            for word in words:
                 word = StringCleaning(word)
                 if word in wordDict:
                     wordDict[word] += 1
                 else:
                     wordDict[word] = 1

    wordList = []
    count = 0
    for key in wordDict:
        if (wordDict[key] <= 6) or (key == "") or (len(key) <= 4): # Arbitrary word length/frequency constraints
            continue
        else:
            appender = [key]
            wordList.append(appender)
            wordList[count].append(wordDict[key])# Puts dictionary values into 2d List
            count += 1

    wordList = sorted(wordList, key=lambda l:l[1], reverse = True) # sorts by values

    wordz = []
    valuez = []
    
    for i in range (len(wordList)): # Strips dictionary into two lists
            wordz.append(wordList[i][0])
            valuez.append(wordList[i][1])

    x = range(len(wordz))

    plt.figure(figsize=(10,5))
    plt.style.use("seaborn-white")
    plt.xticks(x, wordz, rotation="vertical", size=8, fontname="Arial")
    plt.bar(x, valuez, color = "green", width = .25)
    plt.title("@%s's Tweet Vocabulary" %handle, fontweight="bold", fontname="Arial")
    plt.ylabel("Frequency",fontname="Arial")
    plt.xlabel("Words")
    plt.show()

    #TWEEPY>CURSOR // JSON LIBRARY TO GET MORE THAN 200 TWEETS

main()
